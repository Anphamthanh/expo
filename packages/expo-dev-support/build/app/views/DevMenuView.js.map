{"version":3,"file":"DevMenuView.js","sourceRoot":"","sources":["../../../src/app/views/DevMenuView.tsx"],"names":[],"mappings":"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","sourcesContent":["import React from 'react';\nimport { Clipboard, PixelRatio, StyleSheet } from 'react-native';\n\nimport * as DevSupportInternal from '../DevSupportInternal';\nimport * as DevMenu from './DevMenuModule';\nimport DevMenuButton from './DevMenuButton';\nimport { StyledView } from '../components/Views';\nimport DevMenuTaskInfo from './DevMenuTaskInfo';\nimport DevMenuOnboarding from './DevMenuOnboarding';\nimport DevMenuCloseButton from './DevMenuCloseButton';\nimport DevMenuBottomSheetContext, { Context } from './DevMenuBottomSheetContext';\n\ntype Props = {\n  task: { [key: string]: any };\n  uuid: string;\n  devMenuItems: { [key: string]: any };\n  enableDevelopmentTools: boolean;\n  showOnboardingView: boolean;\n};\n\ntype State = {\n  isOnboardingFinished: boolean;\n};\n\n// These are defined in EXVersionManager.m in a dictionary, ordering needs to be\n// done here.\nconst DEV_MENU_ORDER = [\n  'dev-live-reload',\n  'dev-hmr',\n  'dev-remote-debug',\n  'dev-reload',\n  'dev-perf-monitor',\n  'dev-inspector',\n];\n\nconst MENU_ITEMS_ICON_MAPPINGS = {\n  'dev-hmr': 'run-fast',\n  'dev-remote-debug': 'remote-desktop',\n  'dev-perf-monitor': 'speedometer',\n  'dev-inspector': 'border-style',\n};\n\nclass DevMenuView extends React.PureComponent<Props, State> {\n  static contextType = DevMenuBottomSheetContext;\n\n  context!: Context;\n\n  constructor(props: Props, context: Context) {\n    super(props, context);\n\n    this.state = {\n      isOnboardingFinished: !props.showOnboardingView,\n    };\n  }\n\n  collapse = async () => {\n    if (this.context) {\n      await this.context.collapse();\n    }\n  };\n\n  collapseAndCloseDevMenuAsync = async () => {\n    await this.collapse();\n    await DevSupportInternal.closeMenuAsync();\n  };\n\n  onAppReload = () => {\n    this.collapse();\n    DevMenu.reloadAppAsync();\n  };\n\n  onCopyTaskUrl = async () => {\n    const { manifestUrl } = this.props.task;\n\n    await this.collapseAndCloseDevMenuAsync();\n    Clipboard.setString(manifestUrl);\n    alert(`Copied \"${manifestUrl}\" to the clipboard!`);\n  };\n\n  onGoToHome = () => {\n    this.collapse();\n    DevMenu.goToHomeAsync();\n  };\n\n  onPressDevMenuButton = key => {\n    DevMenu.selectItemWithKeyAsync(key);\n  };\n\n  onOnboardingFinished = () => {\n    DevMenu.setOnboardingFinishedAsync(true);\n    this.setState({ isOnboardingFinished: true });\n  };\n\n  maybeRenderDevelopmentTools() {\n    const devMenuItems = Object.keys(this.props.devMenuItems).sort(\n      (a, b) => DEV_MENU_ORDER.indexOf(a) - DEV_MENU_ORDER.indexOf(b)\n    );\n\n    if (this.props.enableDevelopmentTools && this.props.devMenuItems) {\n      return (\n        <>\n          <StyledView style={styles.separator} />\n          {devMenuItems.map(key => {\n            return this.renderDevMenuItem(key, this.props.devMenuItems[key]);\n          })}\n        </>\n      );\n    }\n    return null;\n  }\n\n  renderDevMenuItem(key, item) {\n    const { label, isEnabled, detail } = item;\n\n    return (\n      <DevMenuButton\n        key={key}\n        buttonKey={key}\n        label={label}\n        onPress={this.onPressDevMenuButton}\n        icon={MENU_ITEMS_ICON_MAPPINGS[key]}\n        isEnabled={isEnabled}\n        detail={detail}\n      />\n    );\n  }\n\n  renderContent() {\n    const { task } = this.props;\n    const { isOnboardingFinished } = this.state;\n\n    return (\n      <>\n        {!isOnboardingFinished && <DevMenuOnboarding onClose={this.onOnboardingFinished} />}\n\n        <DevMenuTaskInfo task={task} />\n\n        <StyledView style={styles.separator} />\n\n        <DevMenuButton buttonKey=\"reload\" label=\"Reload\" onPress={this.onAppReload} icon=\"reload\" />\n        {task && task.manifestUrl && (\n          <DevMenuButton\n            buttonKey=\"copy\"\n            label=\"Copy link to clipboard\"\n            onPress={this.onCopyTaskUrl}\n            icon=\"clipboard-text\"\n          />\n        )}\n        <DevMenuButton buttonKey=\"home\" label=\"Go to Home\" onPress={this.onGoToHome} icon=\"home\" />\n\n        {this.maybeRenderDevelopmentTools()}\n        <DevMenuCloseButton\n          style={styles.closeButton}\n          onPress={this.collapseAndCloseDevMenuAsync}\n        />\n      </>\n    );\n  }\n\n  render() {\n    return (\n      <StyledView style={styles.container} darkBackgroundColor=\"#000\">\n        {this.renderContent()}\n      </StyledView>\n    );\n  }\n}\n\nconst styles = StyleSheet.create({\n  container: {\n    flex: 1,\n    paddingTop: 10,\n    borderTopLeftRadius: 10,\n    borderTopRightRadius: 10,\n  },\n  scrollView: {\n    flex: 1,\n  },\n  buttonContainer: {\n    backgroundColor: 'transparent',\n  },\n  separator: {\n    borderTopWidth: 1 / PixelRatio.get(),\n    height: 12,\n    marginVertical: 4,\n    marginHorizontal: -1,\n  },\n  closeButton: {\n    position: 'absolute',\n    right: 12,\n    top: 12,\n    zIndex: 3, // should be higher than zIndex of onboarding container\n  },\n});\n\nexport default DevMenuView;\n"]}